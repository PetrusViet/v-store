<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>VStore</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
<h1>V-Store</h1>
<div th:insert="_menu"/>
<div th:insert="_adminMenu"/>

<div>
    <h2 th:text="${title}" th:if="${title ne null}"/>
</div>

<p>

    <lable>Name</lable>
    <input id="name" type="text" placeholder="name" th:value="${product.getName_product()}"/><br>

    <lable>Price</lable>
    <input id="price" type="number" th:value="${product.getPrice()}"/><br>

    <lable>Number</lable>
    <input id="number" type="number"  th:value="${product.getNumber()}"/><br>

    <input id="id" type="hidden" th:value="${product.getId_product()}"/><br>
    <button type=button onclick="sendJSON()">Update</button>
    <button form="deleteForm">Delete Product</button>

    <form id="deleteForm" method="post" action="/admin/deleteProduct">
        <input type="hidden" name="id" th:value="${product.getId_product()}" >

    </form>

    <script>
    function sendJSON(){

            let name = document.querySelector('#name');
            let price = document.querySelector('#price');
            let number = document.querySelector('#number');
            let id = document.querySelector('#id');
            // Creating a XHR object
            let xhr = new XMLHttpRequest();
            let url = "/admin/editProduct";
            // open a connection
            xhr.open("POST", url, true);

            // Set the request header i.e. which type of content you are sending
            xhr.setRequestHeader("Content-Type", "application/json");

            // Create a state change callback
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {

                    // Print received data from server
                    location.replace(this.responseText);

                }
                else {
                    document.getElementById("demo").innerHTML = "Error: Hay thuc hien lai hanh dong";
                }
            };

            // Converting JSON data to string
            var data = JSON.stringify({ "name_product": name.value,
                                        "price": price.value,
                                        "number": number.value,
                                        "id_product": id.value});

            // Sending data with the request
            xhr.send(data);
        }
</script>
</p>

<i><p th:text="${msg}" th:if="${msg ne null}"/></i>

</body>
</html>